<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SpeakEasy - AI Voice Language Tutor</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üó£Ô∏è</text></svg>">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        .particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0.3;
        }

        .container {
            max-width: 1000px;
            width: 100%;
            position: relative;
            z-index: 1;
        }

        .main-card {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            border-radius: 40px;
            box-shadow: 0 40px 100px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.5);
        }

        .header {
            text-align: center;
            padding: 60px 40px 40px;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 8s infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(20px, 20px); }
        }

        .header h1 {
            color: white;
            font-size: 3.5rem;
            font-weight: 900;
            margin-bottom: 10px;
            position: relative;
            letter-spacing: -1px;
        }

        .header p {
            color: rgba(255, 255, 255, 0.95);
            font-size: 1.3rem;
            position: relative;
            font-weight: 500;
        }

        .content {
            padding: 50px;
        }

        .language-section {
            margin-bottom: 50px;
        }

        .language-section h3 {
            text-align: center;
            font-size: 1.4rem;
            color: #1e293b;
            margin-bottom: 25px;
            font-weight: 700;
        }

        .language-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 15px;
            max-width: 700px;
            margin: 0 auto;
        }

        .language-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 3px solid transparent;
            border-radius: 20px;
            padding: 20px 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .language-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(99, 102, 241, 0.2);
        }

        .language-card.active {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            border-color: #4f46e5;
            box-shadow: 0 15px 40px rgba(99, 102, 241, 0.4);
        }

        .language-card .flag {
            font-size: 2.5rem;
            margin-bottom: 8px;
            display: block;
        }

        .language-card .name {
            font-size: 1rem;
            font-weight: 600;
            color: #1e293b;
        }

        .language-card.active .name {
            color: white;
        }

        .voice-section {
            text-align: center;
            margin: 60px 0;
        }

        .mic-container {
            position: relative;
            display: inline-block;
            margin-bottom: 30px;
        }

        .mic-button {
            width: 160px;
            height: 160px;
            border-radius: 50%;
            border: none;
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            cursor: pointer;
            position: relative;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 20px 60px rgba(99, 102, 241, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .mic-button:hover {
            transform: scale(1.05);
            box-shadow: 0 25px 70px rgba(99, 102, 241, 0.5);
        }

        .mic-button:active {
            transform: scale(0.98);
        }

        .mic-button.recording {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            animation: recordPulse 1.5s ease-in-out infinite;
        }

        @keyframes recordPulse {
            0%, 100% { box-shadow: 0 20px 60px rgba(239, 68, 68, 0.4); }
            50% { box-shadow: 0 30px 80px rgba(239, 68, 68, 0.7), 0 0 0 30px rgba(239, 68, 68, 0.1); }
        }

        .mic-icon {
            width: 70px;
            height: 70px;
            fill: white;
        }

        .status-indicator {
            font-size: 1.4rem;
            font-weight: 600;
            color: #64748b;
            min-height: 40px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .status-indicator.active {
            color: #6366f1;
        }

        .status-indicator.speaking {
            color: #8b5cf6;
        }

        .hint {
            color: #94a3b8;
            font-size: 1.05rem;
            font-weight: 500;
        }

        .chat-section {
            max-height: 400px;
            overflow-y: auto;
            padding: 30px;
            background: linear-gradient(to bottom, #f8fafc 0%, #f1f5f9 100%);
            border-radius: 30px;
            margin-top: 40px;
        }

        .chat-section::-webkit-scrollbar {
            width: 8px;
        }

        .chat-section::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.05);
            border-radius: 10px;
        }

        .chat-section::-webkit-scrollbar-thumb {
            background: #6366f1;
            border-radius: 10px;
        }

        .message {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .message-avatar {
            width: 45px;
            height: 45px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .message.user .message-avatar {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
        }

        .message.assistant .message-avatar {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .message-bubble {
            max-width: 70%;
            padding: 18px 24px;
            border-radius: 24px;
            font-size: 1.05rem;
            line-height: 1.6;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .message.user .message-bubble {
            background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%);
            color: white;
            border-bottom-right-radius: 6px;
        }

        .message.assistant .message-bubble {
            background: white;
            color: #1e293b;
            border-bottom-left-radius: 6px;
        }

        .system-message {
            text-align: center;
            color: #94a3b8;
            font-size: 0.95rem;
            margin: 25px 0;
            padding: 12px;
            background: rgba(148, 163, 184, 0.1);
            border-radius: 12px;
            font-weight: 500;
        }

        .footer {
            text-align: center;
            padding: 30px;
            background: #f8fafc;
            color: #64748b;
            font-size: 0.95rem;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2.5rem;
            }

            .content {
                padding: 30px 25px;
            }

            .language-grid {
                grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
                gap: 10px;
            }

            .mic-button {
                width: 140px;
                height: 140px;
            }

            .mic-icon {
                width: 60px;
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <div class="particles" id="particles"></div>

    <div class="container">
        <div class="main-card">
            <div class="header">
                <h1>üó£Ô∏è SpeakEasy</h1>
                <p>AI-Powered Voice Language Tutor</p>
            </div>

            <div class="content">
                <div class="language-section">
                    <h3>Choose Your Language</h3>
                    <div class="language-grid" id="languageGrid">
                        <div class="language-card active" data-lang="Spanish">
                            <span class="flag">üá™üá∏</span>
                            <span class="name">Spanish</span>
                        </div>
                        <div class="language-card" data-lang="French">
                            <span class="flag">üá´üá∑</span>
                            <span class="name">French</span>
                        </div>
                        <div class="language-card" data-lang="German">
                            <span class="flag">üá©üá™</span>
                            <span class="name">German</span>
                        </div>
                        <div class="language-card" data-lang="Italian">
                            <span class="flag">üáÆüáπ</span>
                            <span class="name">Italian</span>
                        </div>
                        <div class="language-card" data-lang="Portuguese">
                            <span class="flag">üáµüáπ</span>
                            <span class="name">Portuguese</span>
                        </div>
                        <div class="language-card" data-lang="Japanese">
                            <span class="flag">üáØüáµ</span>
                            <span class="name">Japanese</span>
                        </div>
                        <div class="language-card" data-lang="Korean">
                            <span class="flag">üá∞üá∑</span>
                            <span class="name">Korean</span>
                        </div>
                        <div class="language-card" data-lang="Chinese">
                            <span class="flag">üá®üá≥</span>
                            <span class="name">Chinese</span>
                        </div>
                    </div>
                </div>

                <div class="voice-section">
                    <div class="status-indicator" id="statusText">
                        Ready to practice
                    </div>

                    <div class="mic-container">
                        <button class="mic-button" id="micButton">
                            <svg class="mic-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 1C10.34 1 9 2.34 9 4V12C9 13.66 10.34 15 12 15C13.66 15 15 13.66 15 12V4C15 2.34 13.66 1 12 1Z" fill="white"/>
                                <path d="M19 10V12C19 15.87 15.87 19 12 19C8.13 19 5 15.87 5 12V10H3V12C3 16.97 7.03 21 12 21C16.97 21 21 16.97 21 12V10H19Z" fill="white"/>
                                <path d="M11 21V23H13V21H11Z" fill="white"/>
                            </svg>
                        </button>
                    </div>

                    <p class="hint">Click to speak ‚Ä¢ AI responds with voice</p>
                </div>

                <div class="chat-section" id="chatMessages">
                    <!-- Messages will appear here -->
                </div>
            </div>

            <div class="footer">
                ¬© 2025 SpeakEasy ‚Ä¢ Powered by AI
            </div>
        </div>
    </div>

    <script>
        let isRecording = false;
        let currentLanguage = 'Spanish';
        let recognition = null;
        let synthesis = window.speechSynthesis;
        let conversationHistory = [];

        const languageMap = {
            'Spanish': 'es-ES',
            'French': 'fr-FR',
            'German': 'de-DE',
            'Italian': 'it-IT',
            'Portuguese': 'pt-PT',
            'Japanese': 'ja-JP',
            'Korean': 'ko-KR',
            'Chinese': 'zh-CN'
        };

        // Initialize Speech Recognition
        if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            recognition = new SpeechRecognition();
            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = languageMap[currentLanguage];
        }

        // Language selection
        document.getElementById('languageGrid').addEventListener('click', (e) => {
            const card = e.target.closest('.language-card');
            if (!card) return;

            document.querySelectorAll('.language-card').forEach(c => c.classList.remove('active'));
            card.classList.add('active');

            currentLanguage = card.dataset.lang;
            if (recognition) {
                recognition.lang = languageMap[currentLanguage];
            }

            addSystemMessage(`Switched to ${currentLanguage}!`);
        });

        // Microphone button
        document.getElementById('micButton').addEventListener('click', toggleRecording);

        function toggleRecording() {
            if (isRecording) {
                stopRecording();
            } else {
                startRecording();
            }
        }

        function startRecording() {
            if (!recognition) {
                alert('Speech recognition is not supported in your browser. Please use Chrome or Edge.');
                return;
            }

            isRecording = true;
            const micButton = document.getElementById('micButton');
            const statusText = document.getElementById('statusText');

            micButton.classList.add('recording');
            statusText.textContent = 'üé§ Listening...';
            statusText.classList.add('active');

            try {
                recognition.start();
            } catch (e) {
                console.error('Recognition error:', e);
                stopRecording();
            }
        }

        function stopRecording() {
            isRecording = false;
            const micButton = document.getElementById('micButton');
            const statusText = document.getElementById('statusText');

            micButton.classList.remove('recording');
            statusText.classList.remove('active');

            if (recognition) {
                try {
                    recognition.stop();
                } catch (e) {
                    console.error('Stop error:', e);
                }
            }
        }

        async function processVoiceInput(transcript) {
            addMessage('user', transcript);

            const statusText = document.getElementById('statusText');
            statusText.textContent = 'üí≠ Thinking...';
            statusText.classList.add('active');

            const aiResponse = await getAIResponse(transcript);
            addMessage('assistant', aiResponse);

            speakText(aiResponse);
        }

        async function getAIResponse(userMessage) {
            const greetingResponses = {
                'Spanish': [
                    '¬°Hola! ¬øC√≥mo est√°s? Me encanta hablar contigo.',
                    '¬°Buenos d√≠as! ¬øQu√© tal est√°s hoy?',
                    '¬°Hola! Es un placer practicar espa√±ol contigo.'
                ],
                'French': [
                    'Bonjour! Comment allez-vous? Je suis ravi de parler avec vous.',
                    'Bonjour! Comment √ßa va aujourd\'hui?',
                    'Salut! C\'est un plaisir de pratiquer le fran√ßais avec vous.'
                ],
                'German': [
                    'Hallo! Wie geht es Ihnen? Ich freue mich, mit Ihnen zu sprechen.',
                    'Guten Tag! Wie geht es Ihnen heute?',
                    'Hallo! Es ist mir eine Freude, Deutsch mit Ihnen zu √ºben.'
                ],
                'Italian': [
                    'Ciao! Come stai? Sono felice di parlare con te.',
                    'Buongiorno! Come va oggi?',
                    'Ciao! √à un piacere praticare l\'italiano con te.'
                ],
                'Portuguese': [
                    'Ol√°! Como voc√™ est√°? Estou feliz em falar com voc√™.',
                    'Bom dia! Como vai hoje?',
                    'Oi! √â um prazer praticar portugu√™s com voc√™.'
                ],
                'Japanese': [
                    '„Åì„Çì„Å´„Å°„ÅØÔºÅÂÖÉÊ∞ó„Åß„Åô„ÅãÔºü„ÅÇ„Å™„Åü„Å®Ë©±„Åõ„Å¶Â¨â„Åó„ÅÑ„Åß„Åô„ÄÇ',
                    '„Åä„ÅØ„Çà„ÅÜ„Åî„Åñ„ÅÑ„Åæ„ÅôÔºÅ‰ªäÊó•„ÅØ„Å©„ÅÜ„Åß„Åô„ÅãÔºü',
                    '„Åì„Çì„Å´„Å°„ÅØÔºÅÊó•Êú¨Ë™û„ÇíÁ∑¥Áøí„Åß„Åç„Å¶ÂÖâÊ†Ñ„Åß„Åô„ÄÇ'
                ],
                'Korean': [
                    'ÏïàÎÖïÌïòÏÑ∏Ïöî! Ïñ¥ÎñªÍ≤å ÏßÄÎÇ¥ÏÑ∏Ïöî? ÎãπÏã†Í≥º Ïù¥ÏïºÍ∏∞Ìï† Ïàò ÏûàÏñ¥ÏÑú Í∏∞ÏÅ©ÎãàÎã§.',
                    'Ï¢ãÏùÄ ÏïÑÏπ®ÏûÖÎãàÎã§! Ïò§Îäò Ïñ¥ÎñªÍ≤å ÏßÄÎÇ¥ÏÑ∏Ïöî?',
                    'ÏïàÎÖïÌïòÏÑ∏Ïöî! ÌïúÍµ≠Ïñ¥Î•º Ïó∞ÏäµÌï† Ïàò ÏûàÏñ¥ÏÑú ÏòÅÍ¥ëÏûÖÎãàÎã§.'
                ],
                'Chinese': [
                    '‰Ω†Â•ΩÔºÅ‰Ω†Â•ΩÂêóÔºüÂæàÈ´òÂÖ¥Âíå‰Ω†ËÅäÂ§©„ÄÇ',
                    'Êó©‰∏äÂ•ΩÔºÅ‰Ω†‰ªäÂ§©ÊÄé‰πàÊ†∑Ôºü',
                    '‰Ω†Â•ΩÔºÅÂæàËç£Âπ∏ËÉΩÂíå‰Ω†ÁªÉ‰π†‰∏≠Êñá„ÄÇ'
                ]
            };

            const generalResponses = {
                'Spanish': [
                    '¬°Muy bien! Contin√∫a practicando. ¬øQu√© m√°s te gustar√≠a decir?',
                    'Excelente. Cu√©ntame m√°s sobre eso.',
                    'Perfecto. ¬øPuedes explicar eso con m√°s detalle?'
                ],
                'French': [
                    'Tr√®s bien! Continuez. Que voulez-vous dire d\'autre?',
                    'Excellent. Parlez-moi davantage de cela.',
                    'Parfait. Pouvez-vous expliquer cela plus en d√©tail?'
                ],
                'German': [
                    'Sehr gut! Machen Sie weiter. Was m√∂chten Sie noch sagen?',
                    'Ausgezeichnet. Erz√§hlen Sie mir mehr dar√ºber.',
                    'Perfekt. K√∂nnen Sie das genauer erkl√§ren?'
                ],
                'Italian': [
                    'Molto bene! Continua. Cosa vorresti dire ancora?',
                    'Eccellente. Dimmi di pi√π su questo.',
                    'Perfetto. Puoi spiegarlo pi√π in dettaglio?'
                ],
                'Portuguese': [
                    'Muito bem! Continue. O que mais voc√™ gostaria de dizer?',
                    'Excelente. Conte-me mais sobre isso.',
                    'Perfeito. Voc√™ pode explicar isso com mais detalhes?'
                ],
                'Japanese': [
                    '„Å®„Å¶„ÇÇËâØ„ÅÑ„Åß„ÅôÔºÅÁ∂ö„Åë„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ‰ªñ„Å´‰Ωï„ÇíË®Ä„ÅÑ„Åü„ÅÑ„Åß„Åô„ÅãÔºü',
                    'Á¥†Êô¥„Çâ„Åó„ÅÑ„ÄÇ„Åù„Çå„Å´„Å§„ÅÑ„Å¶„ÇÇ„Å£„Å®Êïô„Åà„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ',
                    'ÂÆåÁíß„Åß„Åô„ÄÇ„ÇÇ„Å£„Å®Ë©≥„Åó„ÅèË™¨Êòé„Åß„Åç„Åæ„Åô„ÅãÔºü'
                ],
                'Korean': [
                    'ÏïÑÏ£º Ï¢ãÏäµÎãàÎã§! Í≥ÑÏÜçÌïòÏÑ∏Ïöî. Îòê Î¨¥ÏóáÏùÑ ÎßêÌïòÍ≥† Ïã∂ÏúºÏÑ∏Ïöî?',
                    'ÌõåÎ•≠Ìï©ÎãàÎã§. Í∑∏Í≤ÉÏóê ÎåÄÌï¥ Îçî ÎßêÌï¥Ï£ºÏÑ∏Ïöî.',
                    'ÏôÑÎ≤ΩÌï©ÎãàÎã§. Îçî ÏûêÏÑ∏Ìûà ÏÑ§Î™ÖÌï† Ïàò ÏûàÎÇòÏöî?'
                ],
                'Chinese': [
                    'ÂæàÂ•ΩÔºÅÁªßÁª≠„ÄÇ‰Ω†ËøòÊÉ≥ËØ¥‰ªÄ‰πàÔºü',
                    'Â§™Â•Ω‰∫Ü„ÄÇÂëäËØâÊàëÊõ¥Â§öÂÖ≥‰∫éËøô‰∏™ÁöÑ‰∫ãÊÉÖ„ÄÇ',
                    'ÂÆåÁæé„ÄÇ‰Ω†ËÉΩËß£ÈáäÂæóÊõ¥ËØ¶ÁªÜ‰∏ÄÁÇπÂêóÔºü'
                ]
            };

            const greetingWords = ['hello', 'hi', 'hey', 'hola', 'bonjour', 'salut', 'hallo', 'ciao', 'ol√°', 'oi', '„Åì„Çì„Å´„Å°„ÅØ', 'ÏïàÎÖï', '‰Ω†Â•Ω'];
            const isGreeting = greetingWords.some(word => userMessage.toLowerCase().includes(word));

            const responses = isGreeting ?
                (greetingResponses[currentLanguage] || greetingResponses['Spanish']) :
                (generalResponses[currentLanguage] || generalResponses['Spanish']);

            return responses[Math.floor(Math.random() * responses.length)];
        }

        function speakText(text) {
            const statusText = document.getElementById('statusText');

            if (synthesis.speaking) {
                synthesis.cancel();
            }

            setTimeout(() => {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = languageMap[currentLanguage];
                utterance.rate = 0.9;
                utterance.pitch = 1.0;
                utterance.volume = 1.0;

                utterance.onstart = () => {
                    statusText.textContent = 'üîä AI is speaking...';
                    statusText.classList.add('speaking');
                };

                utterance.onend = () => {
                    statusText.textContent = 'Ready to practice';
                    statusText.classList.remove('speaking', 'active');
                };

                utterance.onerror = (event) => {
                    console.error('Speech error:', event);
                    statusText.textContent = 'Ready to practice';
                    statusText.classList.remove('speaking', 'active');
                };

                const voices = synthesis.getVoices();
                const targetLang = languageMap[currentLanguage];
                const voice = voices.find(v => v.lang.startsWith(targetLang.split('-')[0]));
                if (voice) {
                    utterance.voice = voice;
                }

                synthesis.speak(utterance);
            }, 100);
        }

        function addMessage(role, content) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}`;

            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = role === 'user' ? 'üë§' : 'ü§ñ';

            const bubble = document.createElement('div');
            bubble.className = 'message-bubble';
            bubble.textContent = content;

            messageDiv.appendChild(avatar);
            messageDiv.appendChild(bubble);
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function addSystemMessage(text) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'system-message';
            messageDiv.textContent = text;
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        // Speech Recognition Event Handlers
        if (recognition) {
            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                processVoiceInput(transcript);
            };

            recognition.onerror = (event) => {
                console.error('Recognition error:', event.error);
                const statusText = document.getElementById('statusText');

                if (event.error === 'not-allowed') {
                    alert('Microphone access denied. Please allow microphone access in your browser settings.');
                } else if (event.error === 'no-speech') {
                    statusText.textContent = 'No speech detected. Try again.';
                } else {
                    statusText.textContent = 'Ready to practice';
                }
                stopRecording();
            };

            recognition.onend = () => {
                if (isRecording) {
                    try {
                        recognition.start();
                    } catch (e) {
                        stopRecording();
                    }
                }
            };
        }

        // Load voices
        function loadVoices() {
            return new Promise((resolve) => {
                const voices = synthesis.getVoices();
                if (voices.length > 0) {
                    resolve(voices);
                } else {
                    synthesis.onvoiceschanged = () => {
                        resolve(synthesis.getVoices());
                    };
                }
            });
        }

        // Initialize
        window.addEventListener('load', async () => {
            await loadVoices();
            addSystemMessage('üéôÔ∏è Welcome! Select your language and click the microphone to start speaking.');
        });

        // Create floating particles
        function createParticles() {
            const particles = document.getElementById('particles');
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.style.cssText = `
                    position: absolute;
                    width: ${Math.random() * 4 + 2}px;
                    height: ${Math.random() * 4 + 2}px;
                    background: white;
                    border-radius: 50%;
                    left: ${Math.random() * 100}%;
                    top: ${Math.random() * 100}%;
                    animation: float ${Math.random() * 10 + 10}s infinite ease-in-out;
                `;
                particles.appendChild(particle);
            }
        }

        const style = document.createElement('style');
        style.textContent = `
            @keyframes float {
                0%, 100% { transform: translate(0, 0); opacity: 0.3; }
                50% { transform: translate(${Math.random() * 100 - 50}px, ${Math.random() * 100 - 50}px); opacity: 0.6; }
            }
        `;
        document.head.appendChild(style);
        createParticles();
    </script>
</body>
</html>
